// Another page where ASCII/projects already rendered


const asciiArt = `
                                                       -      ‚àû           -----------------------------
                                                 ‚âà-++-++ +++-+++++++ -+=‚âà√∑-+  √∑√ó ++++++√∑      -------------------
                                            ‚âà+√ó+++√ó-√∑  √∑++++√∑‚âàœÄ+++œÄ‚àû=‚àûœÄ‚â†-√ó‚âà-++++√∑‚âà‚âà   ‚àû‚àû√óœÄ
                                        =+√ó++++-++  ‚âà‚àö-  ‚àû+++-√ó  √ó‚àû+++-√ó=‚â†√∑+‚àû  ‚â†+√ó‚àû-+++=++√∑-+++√ó‚âà     ------------------------------------
                                   √ó+++++‚àû ‚â†   √ó=-‚âà√ó ‚âà++‚âà‚àö+-‚â†‚àö‚âà ‚â†     +-‚àö‚àû‚âà+++‚àû +√ó=-‚àö‚âà√ó+‚àû++  ‚â†=++++++‚â†         -------------------------
                                ‚â†++- œÄ++ œÄ-+‚âà-‚àöœÄ+ ‚àû‚â†‚àö‚àö ‚àö++œÄœÄ‚àû√ó=++‚â†- -= ‚âà+=‚àöœÄ ++√∑=œÄ =+=++œÄ++ ‚âà-‚â†‚â†‚àö‚âà ‚àö++++
                   ‚àû           -------------------------------------------------------------------------------------------------- 
                   √ó++++-+++++++√ó ++‚â†+- ‚âà+‚â†‚àû+‚â† √ó‚â†=‚âà +-+œÄ+++-‚àö‚âà=++‚àö-‚àö++√ó‚àö√∑+œÄ++‚àû‚àö‚â†œÄ+++ œÄ+= ++√∑√∑++++√∑√ó=‚àû+‚àû +‚àû
                        ++++-‚â†+   œÄ√∑‚âà-‚àû‚àû‚âà=√∑‚â†‚â†-++ ‚â†‚àû‚âà+‚â†+‚àö‚àû--+‚â†+= +√∑=‚âà=‚â†√∑‚àû--‚âà+++=√∑ ++++‚âà‚â†++=+√∑-+++=++-+++= ‚âà                  -------------
                                            +---------------------------------------------------------------------------------
                   -+++++ -+ √ó‚â†‚àö‚â†+ ‚â†√ó‚àû+++= =+√∑-√ó√∑=‚àû√ó‚âà+‚âà+‚âà√∑---‚â†-=++ ‚âà-‚àö- ‚â†=√∑√ó‚â†‚àö+‚àû√∑ ‚âà-- =+√∑++-‚â†‚âà+‚àû‚â†++√ó++ -+‚àö++- ---------------------
                 ‚àö+++‚âà- √∑ ++  ‚âà +√ó+√∑√∑‚àö++++√∑‚âà‚àû√∑+√óœÄœÄ‚àû‚àö‚âà√ó+‚â†√∑œÄ√∑-+‚àö√ó==+  =+‚âà‚àû‚â†‚âà=√∑√∑ ++‚âà‚â†‚â†-+‚â†=√ó√∑=++‚âà√ó+√ó++√ó‚àû‚â†‚â†√∑+--‚àö‚àû ----------------   -------------------
                ++++ + ++--+‚àû++ ++=‚â†√ó+‚àû√ó++-√ó‚àö=‚àö- ‚àû++‚àö‚âà+ +√ó+=√∑ √∑ ++  ‚â†+---‚â†√∑-√∑‚àû‚âà-  ‚â†œÄ-+++√ó -+‚àö√ó√ó+++√ó√ó+++-√∑++‚âà++√ó
                                                                                √∑++‚â† + ++‚àö √∑=-+√ó-=‚àû+  +-œÄ==œÄ‚àû=‚â†‚àû-----------------------------------
              +++‚â†  √ó=+-++‚â†‚â†-+‚â†+++-+œÄ ‚àû‚â†œÄ++++- ‚àö ‚â†‚â†œÄ +‚âà√ó ‚àû-+‚â†√ó ‚âà +  œÄ√∑‚àû==   ‚àû‚àû ‚àö=  √ó=+++‚â†=‚àö++++√∑√∑-=-+√ó +++=‚àû‚àö√∑-+
            ‚âà+-‚àû-  √∑‚àö+√ó+++‚âà‚àû√∑+‚àû+++-++√∑œÄ+++œÄ++√∑ √∑√ó+-‚àö ‚àö++ ‚àö=œÄ√∑‚àö ++ + + √∑√∑‚â†‚àö   -------------      +‚â†++‚âà++‚àû+=-+‚âà‚àû√ó+++          ----------------- 
         =œÄ‚àûœÄ‚â†=√ó+ √∑ ‚âà=‚àû+++√∑‚âà‚âà+ ++++-++‚àö√ó+œÄ=++++ ‚àû‚â†√ó=‚â†√ó +√ó‚â†√∑ ‚àû√ó ‚àö+‚â†√ó ‚â†√∑œÄ‚àû‚âà œÄ    ‚àû‚àö√∑  +-+√∑‚â†‚àö‚àö+++++‚âà‚àû‚àû-+√∑ =-+-‚àû=√∑‚àö‚â†---          -------
          ++++√∑+= =‚àû√ó+√ó+--√ó‚â†-+ √ó+++‚àû++------------------------------------------------------------------------------------------------
         ‚â†  ++‚âà+‚â† ‚àö‚âà‚â†‚âà√ó++=œÄ ‚âà+√∑√∑++‚â†-+√ó+-œÄ+++ œÄ-+√∑‚âà œÄ‚â†‚â†- ‚àö ++  √ó-  √ó√óœÄ+    ‚àö‚âà  ‚àöœÄ‚â†‚âà  ‚â†++‚â†  √∑√∑++++==-++œÄ‚àû√∑√∑√ó‚â†=++-√∑ =              ------
        √ó œÄ++- ‚â†‚âà‚â† √ó=‚àö√ó++-√∑‚âà‚àö‚âà+‚àû ++√∑+++-+=++=‚àû ‚âà+-=  ‚âàœÄ+‚àö  ++‚â†‚â†++‚àû‚âà+ +√ó‚àö‚àû√∑‚àû‚âà‚âà   œÄ‚àö‚àö‚àö‚àû++‚àûœÄ +++++--=-++‚âà‚àû+=‚âà√ó++++-         ---- 
       √ó√ó√ó√ó+++œÄ‚âà√∑‚â†+√ó ‚àö++=++‚â† ‚àû++ √∑‚àö‚âà‚â†-++=+œÄ+                                                   ‚â† œÄ== ‚àö=‚àö++++-+++√ó----------------------------------
       √∑√ó ‚âà√∑√∑== ‚âà√∑√∑œÄ  ++=œÄ‚â†+--  ‚àö-‚â†+‚â†√ó√ó‚â† ‚àö+ ‚âà++√ó√∑=√∑‚â†√∑√ó√∑√ó-++++-‚âà‚â†-+++√ó√∑√∑√∑√ó√ó+++++‚àû=‚àû  ‚àû‚âàœÄ œÄ‚â† +++++-++-+√∑++++++++++ +      --------
      √ó‚â†√∑  œÄ‚àö√∑√ó‚âà   ‚â† ‚âà‚àö‚âà+‚â†‚â†√ó+-++‚àû√∑√∑=‚â† =√ó  œÄ+‚àö +++-=œÄ    ‚àö‚àû---+-√∑‚âà            ‚àû++++‚â†=‚âà‚àö‚àö‚àû‚àû√óœÄ+++++++++++++=+++++++‚àö√ó√ó--- -------------- 
       -= ‚â† œÄ‚àû=-‚àö√∑√∑‚àû√∑œÄ √∑  ‚àö‚àû‚â†-‚àö√ó√ó√ó‚àö    ‚â†‚àû‚â†  √ó =+√∑‚âàœÄ          ‚àû‚àû                          œÄ√ó+‚âà+++++++-++‚àö++++++-+‚àû+- 
       √ó   œÄœÄ ‚àö‚àûœÄ=√∑+++‚âà‚àû√∑-‚âà‚àö‚â†+ ‚àûœÄ‚àö  ‚àö    œÄ‚àû+‚âà√ó ‚â†‚â†œÄ                        ------------------------------------------------------------------
       +  +++œÄ   ‚àö   =+√∑ œÄ‚àöœÄ‚àöœÄ - =‚àö        +œÄ-= œÄ                                           =+-√ó+++++-++++++++==√∑√∑œÄ‚â†          -----
       +-œÄ√ó++√∑-‚àû       ‚â†    ‚àö√ó=‚àûœÄ‚àö         √ó=œÄ+œÄœÄ                                         ‚â†  =‚àû=++++++------------            --------------        -------------------------------
       +  œÄœÄ                                                                               √ó++‚âà      ------                              -----------------------------------------------
       +  √ó√ó     œÄ√∑     ‚àû‚àû     œÄ-+‚àû                                                        ‚àö-++++++++++++==-+√ó‚âà    œÄ        ---                          
        œÄ  ‚àû√∑                                                  --------------------------------------------------------------------  √ó-√ó‚àö    --------------------  ---------------------
       ‚àö√∑   ‚àö                                                                            -++++++++++++++√ó√∑++-    √ó=‚â†         -------
        +  ‚â†‚â†                                                        œÄ                   œÄ-+√ó+++++++++√ó+‚àû=++      √ó√∑  =---    ---------------
        -‚â† ‚â†++                                                 ‚â†√ó-√ó√∑    ----------------------------------------                   √ó++++-++++√∑√∑‚âà‚âà√ó++‚àö     =-  +                    -----
        ‚àö+  ++                                            ‚àö√ó√ó√ó+-‚àö                             -++++++√∑‚âà√ó++√∑        √ó                          --        
   =     +œÄ‚àû+++                                        =√ó---√∑‚àû                             +√∑ √∑=++++√óœÄ-=-  √∑         ‚àû                           --------
      ‚àö  -  +++                                       œÄ       ‚âà‚àû  ‚âà‚âà√∑==‚â†‚â†‚àö‚àû=‚â†              ‚àö+++++++‚âàœÄ =+√ó ‚â†+√ó‚àû œÄ‚àû‚âà   +                                --------------- -------- ------ --
         ‚àûœÄœÄ+++                                 ----------------------------------------------------------------------------------------------------------------                √∑√ó-√∑   √ó
          √ó-√ó++                                       œÄ=++  œÄ+   ++++‚àû√∑+                              œÄ+   √∑√∑œÄ   ‚àö------------                     ----------------------
           √∑‚àö=‚àö  œÄ=++++√ó-++√ó‚àö                       ‚àö --   ‚àû      √∑++++                               -         ‚âà‚àö  ‚âà                                 ----------------------------------
            -‚àö                                           +√ó‚àö‚àö                                        +        ‚àû√ó   ‚âà    -                              ---------------------------------
              -‚àö           +++++++=√∑=√ó‚àû                                                             ‚âà‚àö       ‚àö    ‚âà                ---------        
                √∑      -++++√ó‚àö++√∑+========                    =‚àûœÄ                                                ‚â†+         ‚àö                               ----------------- 
                √óœÄ  ‚àû+++   -++++++  ‚àö                                                                                                  ----               >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
             +++++   =                                                                                   œÄ                        -----                    
                  +                                                                                              ‚âà--
                  √ó                                                                                           ‚àû---                -    -------------------------------------------------
                                                                                                           +‚âà                         --------                
                                                                                                           ‚â†                                          --------------------
----                      
                                                                                                                           -----                      -----     
                                                                                                                                               ------                         **********
                                                                                                                         ----------               
                                                                                                                ------------------------                    ----------------------------
                                                                                                       --------                                               
                                                           √ó                                                 ---------                                         
                                                 ‚â†√ó-√∑√ó√ó++-‚àö                                               ------------------                                       ---------------------
                                             œÄ  =√∑√ó‚â†‚àöœÄœÄ-----                                             ---------------------------   
                                                                                -------------------------------------------------------------------------------------------
                                                                                                                                                      
                                                                                                                                                      ----------------------------------
                                                                                                                 --------                                     
                                                                                                                      ------------------------------------
                                                                                                              ----------------------                              ------------------
                                                             œÄ‚â†-+++√ó                                                                                  ----------------------------------
                                                     √∑++++--+-+=                                                                                      
                                        ‚àû‚àö√ó-------++--œÄ                                                                                    -------------------------------------
                                                                                     -                                                                 
                                                                                                      ---------------------                                    -------------------------
                                                                                                        ---------------------                                              
                                                                                                   -------------                      -----------------
            œÄ                                                                                œÄ    ----                                                      ----------------------------
             œÄ                                                                            ‚àö                                     -----------                       
              œÄ                                                                         œÄ                          -=====================---------------------------------------
               œÄ                                                                       √∑œÄ                                                              
               œÄ                          ‚àö                                         ‚âà                                                                 
                 ‚àö‚âà                                                               =‚âà                                      ‚â†+++                        
                  -                         +                                  ‚àû‚âà‚âà                                           +++‚àö             --------------------------------------
                 ‚â†‚àö                       ++++                             œÄ‚â†‚àû‚àö  œÄœÄ                                         +++++++                   
                =-                      ++++++++                        ‚àû‚âà‚àûœÄ                                               √∑++++++++++œÄ               --------
                         ‚âà-+                      œÄ++++++++++‚àö √∑√∑               √∑‚âà‚àö                                                    ++++++++++++++++
           √ó+‚âà                       +++++++√ó+++++      ‚àö‚àö‚àû‚àû‚àö‚àö‚àö=‚àû                                                         +++++++++++++++++++         ---------------------------
        ‚àö-+                         +++++++++++√∑‚â†++                                                                      ++++++++++++++++++++++       
      =+                          ‚àû+++++++++++‚âà‚âà+++                                                                     √ó++++++++++++++++++++++++     
    œÄ+                           ++++++++++++‚âà√ó+++++                                                                    ++++++++++++++++++++++++++++          -----------------------
  ‚â†√ó                            +++++++++++‚â†=+++++√ó                                                                    +++++++++++++++++++++++++++++++--                 ---------------
                               +++++++++++√ó√∑++++                                                                      ++++++++++++++++++++++++++++++++
  =                             +++++++++++-√ó+++                                                                       ++++++++++++++++++++++++++++++++-
                            √∑++++++++++++√ó+++                                                                       ++++++++++++++++++++++++++++++++++                ---------------  -
                               ‚àö+++++++++++‚âà+++√ó                                                                       +++++++++++++++++++++++++++++++++++  
                               +++++++++√ó-√∑-+++                                                                       ++++++++++++++++++++++++++++++++++++         ---------------------
                                +++++++++++√∑-+++                                                                       +++++++++++++++++++++++++++++++++++++
                               +++++++++++-++++                                                                       ++++++++++++++++++++++++++++++++++++√ó     -  ---------------------
                               +++++++++++-++++                                                                      +++++++++++++++++++++++++++++++++++√ó‚â†  
                        +++++++++++-++++                                                                      +++++++++++++++++++++++++++++++++++=œÄ          ----------- ---------------
                         ‚âà+++++++++++++                                                                      √ó+++++++++++++++++++++++++++++++++√∑œÄ     
       ‚âà                                                              +++++++++                                                                      +++++++++++++++++++++++++++++++++√∑‚àö
 `;


// Text to be rendered for nav menu options

const contentMap = {
    Projects: `Brave, 2024 /// <i>Embedded AI-driven sound synthesiser, Network-bending</i>\n
Ancestral (r)Evocations, 2024 /// <i>Archival sonification instrument, Live ML feedback soundscape</i>\n
Iconostasis, 2023 /// <i>Audio-reactive roses, JavaScript + PureData<\i>`,
    CV: `This is the CV content.\nMore lines here...`,
    Bio: `.ñ•î ›Å Àñ London, UK

Software engineer & technologist, designing systems/objects that interplay with the digital layers that surround us 
(electronics, algorithms, surveillance technologies, artificial intelligence, information networks ‚Ä¶ ) 


GitHub <<<<<<<<<<
LinkedIn <<<<<<<<`,
    Contact: `please feel free to contact me ‚äπ‚ï∞(‚å£ ü‚å£)‚ïØ‚äπ
email: danmanzdesign@gmail.com
number: +44 7581 466 806
instagram: @manzzzzzzzzzzd
`
};

// Links to projects
const projectsLinks = {
  'Brave, 2024 /// <i>Embedded AI-driven sound synthesiser, Network-bending</i>\n': 'brave.html',
  'Ancestral (r)Evocations, 2024 /// <i>Archival sonification instrument, Live ML feedback soundscape</i>': 'ancestral.html',
  'Iconostasis, 2023 /// <i>Audio-reactive roses, JavaScript + PureData<\i>': 'iconostasis.html'
};

const bioLinks = {
  'GitHub': 'https://github.com/danielmanz17',
  'LinkedIn': 'https://www.linkedin.com/in/daniel-manz-a0464b1b2/'
};


document.addEventListener("DOMContentLoaded", () => {
  const asciiTarget = document.getElementById("ascii-art");

  let asciiIndex = 0;
  let asciiDisplay = asciiArt.split('').map(ch => (ch === '\n' ? '\n' : ' '));

  const nonSpaceIndices = [];
  for (let i = 0; i < asciiArt.length; i++) {
    if (asciiArt[i] !== ' ' && asciiArt[i] !== '\n') {
      nonSpaceIndices.push(i);
    }
  }
  
  // Render ASCII art instantly
  asciiTarget.textContent = asciiArt;

  const textBox = document.getElementById("text-box-nav");

  function renderTextBox(text, linksMap = null, instant = false) {
    function escapeRegExp(string) {
      return string.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&');
    }

    if (instant) {
      // Instant render with line breaks and links
      let html = text.replace(/\n/g, '<br>');
      if (linksMap) {
        Object.entries(linksMap).forEach(([txt, href]) => {
          // Convert the link text from contentMap format to HTML format for matching
          const htmlText = txt.replace(/\n/g, '<br>');
          const regex = new RegExp(escapeRegExp(htmlText), 'g');
          const isExternal = href.startsWith('http');
          const anchor = `<a href="${href}"${isExternal ? ' target="_blank"' : ''}>${htmlText}</a>`;
          html = html.replace(regex, anchor);
        });
      }
      textBox.innerHTML = html;
      return;
    }

    // Incremental typing effect
    let i = 0;
    const chars = text.split('');
    const display = [];

    function renderStep() {
      if (i < chars.length) {
        display.push(chars[i]);
        textBox.innerHTML = display.join('').replace(/\n/g, '<br>');
        i++;
        setTimeout(renderStep, 0);
      } else if (linksMap) {
        Object.entries(linksMap).forEach(([txt, href]) => {
          // Convert the link text from contentMap format to HTML format for matching
          const htmlText = txt.replace(/\n/g, '<br>');
          const regex = new RegExp(escapeRegExp(htmlText), 'g');
          const isExternal = href.startsWith('http');
          const anchor = `<a href="${href}"${isExternal ? ' target="_blank"' : ''}>${htmlText}</a>`;
          textBox.innerHTML = textBox.innerHTML.replace(regex, anchor);
        });
      }
    }

    renderStep();
  }

  // Initially render Projects section instantly
  renderTextBox(contentMap['Projects'], projectsLinks, true);

  // Making nav links clickable
  document.querySelectorAll('nav .menu li a').forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      const key = e.target.textContent.trim();
      
      console.log('Clicked nav item:', key); // Debug log
      console.log('Available keys:', Object.keys(contentMap)); // Debug log
      
      if (key === 'CV') {
        window.open('./assets/docs/cv.pdf', '_blank');
      } else if (key === 'Projects' || key === 'Portfolio') {
        // Handle both "Projects" and "Portfolio" text - render with typing animation when clicked
        renderTextBox(contentMap['Projects'], projectsLinks, false);
      } else if (key === 'Bio') {
        renderTextBox(contentMap['Bio'], bioLinks, false);
      } else if (key === 'Contact') {
        renderTextBox(contentMap['Contact'], null, false);
      } else {
        console.log('No matching content for key:', key); // Debug log
      }
    });
  });
});